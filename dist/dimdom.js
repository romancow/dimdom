// Generated by CoffeeScript 1.10.0
(function() {
  var DimDom,
    hasProp = {}.hasOwnProperty;

  DimDom = (function() {
    var ensureArray, findConstructorArgs, isChildren, isObject, isString;

    function DimDom(name, attributes, styles, children) {
      var ref;
      ref = findConstructorArgs(name, attributes, styles, children), name = ref[0], attributes = ref[1], styles = ref[2], children = ref[3];
      Object.defineProperties(this, {
        name: {
          value: name
        },
        attributes: {
          value: attributes
        },
        styles: {
          value: styles
        },
        children: {
          value: children
        }
      });
    }

    DimDom.prototype.create = function(document) {
      var child, i, len, name, node, ref, ref1, ref2, value;
      node = document.createElement(this.name);
      ref = this.attributes;
      for (name in ref) {
        if (!hasProp.call(ref, name)) continue;
        value = ref[name];
        if (value != null) {
          node.setAttribute(name, value);
        }
      }
      ref1 = this.styles;
      for (name in ref1) {
        if (!hasProp.call(ref1, name)) continue;
        value = ref1[name];
        if (value != null) {
          node.style[name] = value;
        }
      }
      ref2 = this.children;
      for (i = 0, len = ref2.length; i < len; i++) {
        child = ref2[i];
        if (child instanceof DimDom) {
          child.appendTo(node);
        } else {
          if (!(child instanceof Node)) {
            child = document.createTextNode(child);
          }
          node.appendChild(child);
        }
      }
      return node;
    };

    DimDom.prototype.appendTo = function(node) {
      var child;
      child = this.create(node.ownerDocument);
      node.appendChild(child);
      return this;
    };

    findConstructorArgs = function(name, attributes, styles, children) {
      var ref, ref1, ref2;
      if (!isString(name)) {
        throw new TypeError("DimDom name must be a string, not \"" + (typeof name) + "\"");
      }
      if (isChildren(attributes)) {
        ref = [{}, {}, attributes], attributes = ref[0], styles = ref[1], children = ref[2];
      } else if (isChildren(styles)) {
        ref2 = [(ref1 = attributes['styles']) != null ? ref1 : {}, styles], styles = ref2[0], children = ref2[1];
        delete attributes['styles'];
      }
      children = ensureArray(children);
      return [name, attributes, styles, children];
    };

    isString = function(val) {
      return (typeof val === 'string') || (val instanceof String);
    };

    isObject = function(val) {
      return (val != null) && (typeof val === 'object') && !Array.isArray(val);
    };

    isChildren = function(val) {
      return (val instanceof DimDom) || (val instanceof Node) || !isObject(val);
    };

    ensureArray = function(val) {
      if (val == null) {
        return [];
      } else if (Array.isArray(val)) {
        return val;
      } else {
        return [val];
      }
    };

    return DimDom;

  })();

}).call(this);
